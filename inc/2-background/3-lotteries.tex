\section{Lotteries}
\label{sec:lotteries}

Shamir et al. in \cite{shamir_mental_1981} introduced a protocol for two parties playing virtual card games that involve randomness without a trusted intermediary. Playing so-called mental poker has been studied further in \cite{goldreich_how_1987} where the authors suggest a protocol to play any mental game that will work between any number of players at least as there is an honest majority. Lotteries are also mental games that require randomness, but since they typically have many participants and are susceptible to sybil attacks, traditional mental poker protocols won't easily work.

Syverson in \cite{syverson_weakly_1998} and Goldschlag and Stubblebine in \cite{goldschlag_publicly_1998} suggested using data from sold tickets in a lottery as a source for entropy for a random function in order to create a lottery with a verifiable random process. A lottery where only internal information is used in the random process is called \emph{committed} or \emph{closed}. Such internal information could be a number embedded in the ticket itself, chosen randomly by the ticket owner. Both their protocols require some time to elapse between when the last ticket is bought – which finalizes the input to the random function – and when the result of the random function is available. Goldschlag and Stubblebine employ a delay function that takes a minimum time to calculate to achieve this, while Syverson include a weakly encrypted secret in each ticket that is moderately hard, but not infeasible, to decrypt and use to calculate the random function.

The concepts of a closed lottery and using delay functions in the random process have been used by a number of similar schemes in later contributions. Various enhancements such as privacy in \cite{zhou_playing_2001} and more use of fair exchange in \cite{chow_e-lottery_2005} have been suggested. A number of schemes use other means to generate randomness; such as verifiable random numbers generated by a committee of semi-trusted delegates in \cite{fouque_sharing_2001, lee_design_2009, liu_improved_2014, xia_information_2019}. Grumbach and Riemann in \cite{grumbach_distributed_2017} use a random process inspired by distributed voting schemes – a Kademlia DHT where each participant is a node who cooperates with other players in their subtree to generate verifiable randomness. 

Although these schemes can generate randomness for a lottery without a trusted intermediary, they don't provide equally trustless solutions to the other aspects of organizing a lottery. One issue is simply to have the participants agree on who are actually participating. Most schemes solve this by having a lottery organizer digitally sign tickets so that the signature proves that a ticket is indeed valid. Should the lottery organizer refuse to pay the prize to a holder of a valid ticket, the ticket owner would have to give up or complain to some other authority. This can be solved by storing the prize money with a bank or payment processor who issues tickets and prizes based on fair exchange, but then we involve the bank or payment processor as a trusted intermediary. 

If the lottery is closed and information from the tickets are used as input to the random process, the organizer and participants need to agree on what is the correct set of tickets to be used. Since the organizer is the one who issues tickets, they could choose to not issue tickets during the last part of the purchase phase. Doing so, the organizer can choose what input to use for the random function, and possibly calculate a delay function before the purchasing phase is finished. This issue is identified in the literature, and can be handled in at least one of two ways. One possible way of handling it is to require that the organizer publish the entire ledger of tickets continuously. It doesn't solve the issue completely, but it allows observers to see if suspicious behaviour is going on \cite{syverson_weakly_1998}. Another solution is to have a trusted intermediary who can also issue tickets if the organizer is unresponsive to requests \cite{zhou_playing_2001}.

Syverson and Goldschlag et al. in \cite{syverson_weakly_1998} and \cite{goldschlag_temporarily_2010} discuss the topic of a \emph{pari-mutuel} lottery concerning the organizer's ability to issue free tickets for themselves. If the lottery is pari-mutuel, meaning the entire prize pool comes from purchased tickets, the expected value of a ticket is independent on the number of tickets in existence, as the chance of winning decreases proportionally to the increased prize. But if the prize pool is larger than the cost of all tickets, the organizer would increase their expected value by forging tickets for themselves. Their conclusion is that a distributed lottery needs to be pari-mutuel unless it can manage sybil behaviour by the organizer.

A number of lotteries have appeared on various blockchains. Due to the openness and verifiability of blockchain transactions, anyone with some coding skills can create a lottery or verify a lottery's fairness on such a platform. Although creating a completely fair lottery on a blockchain platform is non trivial, some claim to have accomplished the feat. SmartBillions \cite{noauthor_smartbillions_nodate} is a lottery on Ethereum that instantly pays out prizes. It's more akin to scratching tickets in that players play on their own without interacting with other players of the same game. One simply chooses a lucky number and finds out if one wins or not when the next block is mined. The randomness does however come from a block hash which is not considered secure for large prizes, as it can be manipulated by miners \cite{bonneau_bitcoin_2015, pierrot_malleability_2018}. 
FairLotto \cite{ago_fairlotto_2018} is another lottery implemented on the Steemit blockchain. It works more as a typical lottery in that participants contribute to a prize pool by buying tickets, and one winner is selected by random to receive a share of the prize. It does however also rely on randomness from a source that can be manipulated by miners. It combines a secret the lottery organizer has committed to, and the transaction id of the last ticket bought to generate a random number that will be used to select the winner. In such a scheme the organizer can potentially bribe miners to tactically select a transaction to be the last ticket, so that a ticket owned by the organizer will win. 
There are other lotteries that use cryptocurrencies such as \cite{noauthor_satoshi_nodate}, but their randomness is completely generated by the lottery organizer, so it's actually just an online casino that uses cryptocurrencies, and not a distributed lottery protocol.

There has also been interest in distributed lotteries on the blockchain in the academic literature. Andrychowicz et al. proposed a lottery implemented in Bitcoin transactions in \cite{andrychowicz_secure_2014}. The authors identified argued that multiparty computation (MPC) on a blockchain can enforce honest behaviour by having participants make deposits that will be confiscated if they fail to follow the protocol of the computation. This can potentially solve the problem of previous lottery schemes that eventually have to rely on a trusted third party to enforce payments and correct behaviour by the lottery organizer.

Following Andrychowicz et al., more Bitcoin based lotteries have been designed, including one concurrent by Bentov et al. \cite{bentov_how_2014}. These two schemes do however require a deposit that grows polynomially with the amount of participants. This makes a large lottery impractical, as prohibitively high deposits would be necessary to play the lottery securely. Bartoletti and Zunino in \cite{bartoletti_constant-deposit_2017} and Miller and Bentov in \cite{miller_zero-collateral_2017} independently designed similar lotteries that require only a constant or zero deposit. These lotteries work by constructing a tournament of digital coin tosses where each participant is paired with an opponent in $log_2(N-1)$ rounds for a lottery with $N$ participants. Half the participants are eliminated in each round until there is one winner left who can claim the prize. This scheme does a trade-off by minimizing deposits but increasing the number of rounds from being $O(1)$ to being $O(log(N))$. 
