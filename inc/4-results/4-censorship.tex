\section{Cost of a censorship attack}
\label{sec:censorship}
% More at risk: high exposure; cost of attack: disruption cost
The most concerning attack is probably one where miners tactically censor the transactions of one participant's opponents through the entire lottery. If a participant is not able to make their commit and reveal transactions, they lose that match. From the miners' perspective, a block reorganization attack is risky and expensive as it might fail, but a censorship attack is almost cost-less for a powerful collusion of miners, as failing does not necessarily have a cost. This means that if a miner is completely unconcerned with keeping the network healthy, even a marginal bribe would make it worth to censor someone. One could counter a small bribe by increasing the gas price in a transaction, so that the miner will be paid more in transaction fees than what the bribe is worth, but a briber would still have an advantage, as the rewards of a successful attack would fund their activity. 

In practice, not many miners are willing to take bribes for censorship, as they are either idealistic or have an interest in maintaining the reputation of the blockchain as a secure computing platform. At least, the latter point is the case if miners have skin in the game of the blockchain, such as owning mining hardware specific for that chain or having large holdings of the currency of that blockchain. If a blockchain gets a reputation for being susceptible to censorship, the demand of the chain's cryptocurrency might decrease significantly, and thus indirectly hurt miners who engage in censorship. Nonetheless, it's still useful to assess the feasibility of a censorship attack, as the value at stake in a large lottery can be extraordinarily high.

A lottery has $L$ levels in its tournament and $N=2^L$ players and a prize of $p r 2^L$ where $r$ is the ratio of ticket deposits that go to the prize and $p$ is the ticket price. Ideally, each player has a $\frac{1}{2^L}$ chance of winning, so that the expected value of participation is $\frac{p r 2^L}{2^L}=pr$. For each round an adversary can successfully censor their opponent, they double their chance of winning and thus double their expected value. Note that the expected value doubles for each round, so that in the first round the expected return is $pr$, while in the last round it's $2^{L-1}pr$. So if bribing miners to censor one's opponent is barely worth it in one round, it's certainly worth it in the next round.

A censorship attack has a probability of succeeding for each block produced. If we assume there is not a powerful selfish miner that has the power to both censor transactions and force the network to abandon blocks that include transactions targeted for censorship, there is a probability that an honest miner will include the targeted transactions. Since a coalition of selfish miners can be effective with as little as 25\% of the mining power, and certainly at 50\% of the mining power, we assume that in the worst case only 50\% of the miners are honest. If the fraction of honest miners is any less than that, then censorship by selfish miners dominates the threat model. We see that even with just half of the miners being honest, the likelihood of a transaction being included in a block gets very high after just a dozen blocks. $p_{included} = 1-0.5^{12}=99.9756\%$. Therefore, the time limits in matches should be sufficiently large so that the risk of a successful censorship attack without the selfish miner strategy is negligible.

We can measure the reward of censoring a participant in one round by the increase in expected return for the adversary. As noted before, this reward will increase exponentially as we get closer to the final match in the tournament. This also means that the reward in large lotteries will be correspondingly large. If we assume a dollar value of a ticket be to 10 USD and we have $2^{16}=65536$ participants, the reward of censoring your opponent in the last match will be $\frac{10 \cdot 2^{16}}{2}=327680$ USD, which at today's ether price makes it well worth it for a miner to risk losing some block rewards in order to get a chunk of the prize \footnote{The block reward in Ethereum is as of 2019-05-07 2 ether or 352 USD (\url{https://etherscan.io/}).}.

As the adversary's opponent in a match reveal their secret by broadcasting a reveal transaction to the network, the adversary and the colluding miners, or anyone with knowledge of the adversary's secret, will know what the result of the match will be after the reveal transaction is broadcast. Since the match consists of a digital coin toss, in 50\% of the cases there will be no need for censorship at all for the adversary to win. The adversary can choose to censor only when they will not win honestly. This puts the honest participant at a disadvantage, as even though they can counter the bribe by making a transaction with a high gas price, they won't know whether they will win or not until the adversary has made their transaction.

This means that in the case of an honest player playing a match against an adversary engaging in censorship, the adversary would be willing to spend double the amount to bribe miners of what the honest player is willing to pay in transaction costs to counter such a bribe. An honest participant would only be willing to spend the entire expected value at that level, while the adversary is willing to spend double that if they know they would lose by playing honestly.

As to whether miners would accept bribes to censor, we don't know of any estimates of how large a bribe must be for miners to collude in such a way. Assuming it is possible to bribe a powerful miner to censor transactions at all, the possible rewards of doing so increases as the lottery gets larger, so it will eventually be high enough. An opportunistic collusion of miners could also perform such an attack on their own by participating in the lottery â€“ removing the necessity of bribing.

Based on the analysis in this section, we conclude that our proposed lottery is only secure under the assumption that there is no successful selfish miner behaviour on the blockchain. This is because a selfish miner collusion with about a third of the mining power can in some cases effectively censor transactions, and our lottery requires transactions to be included in blocks within reasonable time. A selfish miner collusion with less than 25\% of the mining power is very unlikely to succeed, while the likelihood of success increases the higher their fraction of mining power is. If such an attack can happen in practice, participants in the lottery ultimately have to trust the miner collusion to act honestly, and introducing a trusted intermediary goes against the entire purpose of distributed lotteries. 

This can only be partly mitigated by having more time between time limits in matches. Such a censorship attack is essentially costless if we ignore indirect costs such as the blockchain's reputation being hurt, and can be sustained indefinitely as long as the collusion of miners is powerful enough. We instead would recommend to not hold large lotteries or lotteries with very high prizes, and to be vary if the blockchain has powerful miners or high risk of miner collusion.
